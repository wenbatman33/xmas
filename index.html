<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merry Christmas!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* * æ ¸å¿ƒé…è‰² 
         * ä¿®æ”¹ç‚ºã€Œç¶ æ¨¹ç´…åº•ã€é…è‰²
         */
        :root {
            --bg-color: #990000;       /* è–èª•ç´…èƒŒæ™¯ */
            
            /* æ¨¹çš„æœ¬é«”é¡è‰² (é—œé–‰ç‹€æ…‹) - æ”¹ç‚ºæ·±ç¶ è‰²ç³» */
            --switch-off-bg: #064e3b;  /* æ¥µæ·±ç¶ è‰² (æ¨¹è‘‰é™°å½±) */
            --knob-off: #166534;       /* æ·±ç¶ è‰² (æ¨¹è‘‰) */
            --knob-on: #ffffff;        /* é–‹å•Ÿæ™‚åœ“éˆ•ä¿æŒç™½è‰² */
            
            /* äº®èµ·æ™‚çš„é¡è‰²è®Šæ•¸ - å¢åŠ å¤šç¨®ç¶ è‰² */
            --active-green-light: #4ade80;   /* å«©ç¶ è‰²/äº®ç¶  */
            --active-green-medium: #22c55e;  /* æ­£ç¶ è‰² */
            --active-green-dark: #15803d;    /* æ·±ç¶ è‰² */
            
            /* é»ç¶´è‰² (è£é£¾å“) */
            --active-red: #ef4444;     
            --active-gold: #fbbf24;    
            --active-white: #f8fafc;   
        }

        body {
            background-color: var(--bg-color);
            font-family: 'Courier New', Courier, monospace;
            overflow: hidden; /* é˜²æ­¢æ²è»¸ */
        }

        /* * é–‹é—œæœ¬é«” (å®¹å™¨)
         */
        .switch {
            position: relative;
            height: 28px;
            border-radius: 999px; /* è† å›Šå½¢ç‹€ */
            background-color: var(--switch-off-bg);
            cursor: pointer;
            transition: background-color 0.3s ease;
            display: inline-block;
            margin: 4px;
            /* åˆå§‹å¯¬åº¦ï¼Œæœƒè¢« JS è¦†è“‹ */
            width: 50px; 
        }

        /* * é–‹é—œè£¡çš„åœ“éˆ• (Knob)
         */
        .knob {
            position: absolute;
            top: 4px;
            left: 4px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: var(--knob-off);
            transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* * å‹•ç•«å®šç¾©
         * è®“é–‹é—œä¸æ–·åœ°å¾ Off -> On -> Off å¾ªç’°
         */
        @keyframes toggleLoop {
            0%, 10% {
                /* é—œé–‰ç‹€æ…‹ */
                background-color: var(--switch-off-bg);
            }
            10% {
                /* åœ“éˆ•é‚„åœ¨å·¦é‚Šï¼Œé¡è‰²é–‹å§‹è®Š */
                background-color: var(--switch-off-bg);
            }
            20% {
                /* é–‹å•Ÿéç¨‹ */
                background-color: var(--target-color);
            }
            45%, 55% {
                /* ä¿æŒé–‹å•Ÿç‹€æ…‹ä¸€æ®µæ™‚é–“ */
                background-color: var(--target-color);
            }
            65% {
                /* æº–å‚™é—œé–‰ */
                background-color: var(--target-color);
            }
            75%, 100% {
                /* å›åˆ°é—œé–‰ */
                background-color: var(--switch-off-bg);
            }
        }

        @keyframes knobLoop {
            0%, 10% {
                transform: translateX(0);
                background-color: var(--knob-off);
            }
            20%, 65% {
                /* ç§»å‹•åˆ°å³å´ */
                transform: translateX(calc(100% + 4px)); 
                background-color: var(--knob-on);
            }
            75%, 100% {
                transform: translateX(0);
                background-color: var(--knob-off);
            }
        }

        /* æ‡‰ç”¨å‹•ç•«çš„é¡åˆ¥ */
        .animating {
            animation: toggleLoop 4s infinite ease-in-out;
        }
        
        /* * ç”±æ–¼æ¯å€‹é–‹é—œå¯¬åº¦ä¸åŒï¼Œknob çš„ä½ç§»è·é›¢éœ€è¦å€‹åˆ¥è™•ç†
         */
         
        .switch.w-12 .knob-anim { animation: knobMoveSmall 4s infinite ease-in-out; }
        .switch.w-16 .knob-anim { animation: knobMoveMedium 4s infinite ease-in-out; }
        .switch.w-20 .knob-anim { animation: knobMoveLarge 4s infinite ease-in-out; }

        @keyframes knobMoveSmall {
            0%, 15% { transform: translateX(0); background-color: var(--knob-off); }
            25%, 60% { transform: translateX(20px); background-color: var(--knob-on); } 
            70%, 100% { transform: translateX(0); background-color: var(--knob-off); }
        }
        @keyframes knobMoveMedium {
            0%, 15% { transform: translateX(0); background-color: var(--knob-off); }
            25%, 60% { transform: translateX(36px); background-color: var(--knob-on); }
            70%, 100% { transform: translateX(0); background-color: var(--knob-off); }
        }
        @keyframes knobMoveLarge {
            0%, 15% { transform: translateX(0); background-color: var(--knob-off); }
            25%, 60% { transform: translateX(52px); background-color: var(--knob-on); }
            70%, 100% { transform: translateX(0); background-color: var(--knob-off); }
        }

        /* * Logo æ¨£å¼ 
         */
        .logo-text {
            color: #fff;
            letter-spacing: 4px;
            font-weight: 700;
            opacity: 0.9;
        }
        .logo-accent {
            color: var(--active-gold); /* é‡‘è‰² */
        }

        /* YouTube å°è¦–çª—æ¨£å¼
         * å›ºå®šåœ¨å³ä¸‹è§’ï¼Œè¨­æœ‰é‚Šæ¡†å’Œé™°å½±ï¼Œä½¿å…¶çœ‹èµ·ä¾†åƒå€‹è£é£¾
         */
        .video-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 240px;
            height: 135px; /* 16:9 æ¯”ä¾‹ */
            z-index: 100;
            border: 4px solid var(--active-gold);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            background-color: #000;
            opacity: 1; /* ç¢ºä¿å®Œå…¨å¯è¦‹ */
            transition: transform 0.3s ease;
        }
        
        /* æ»‘é¼ ç§»ä¸Šå»ç¨å¾®æ”¾å¤§ */
        .video-container:hover {
            transform: scale(1.05);
        }

        /* æ·»åŠ ä¸€å€‹å°æ¨™ç±¤èªªæ˜ */
        .video-label {
            position: absolute;
            top: -25px;
            right: 0;
            color: var(--active-gold);
            font-size: 12px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen">

    <!-- YouTube æ’­æ”¾å™¨å®¹å™¨ (å³ä¸‹è§’) -->
    <div class="video-container">
        <!-- æ¨™ç±¤èªªæ˜ (åœ¨ container å…§éƒ¨æˆ–å¤–éƒ¨å®šä½éƒ½å¯ä»¥ï¼Œé€™è£¡ç”¨ CSS çµ•å°å®šä½è™•ç†) -->
        <div class="video-label">BGM: Christmas Vibes ğŸµ</div>
        <div id="youtube-player"></div>
    </div>

    <!-- ä¸»è¦å®¹å™¨ -->
    <div id="tree-container" class="flex flex-col items-center gap-2 mb-12">
        <!-- Javascript æœƒåœ¨é€™è£¡ç”Ÿæˆé–‹é—œ -->
    </div>

    <!-- åº•éƒ¨æ–‡å­— -->
    <div class="logo-text text-xl">
        <span class="logo-accent">Merry</span> Christmas!
    </div>

    <script>
        const container = document.getElementById('tree-container');

        // å®šç¾©æ¯ä¸€å±¤çš„é–‹é—œæ•¸é‡èˆ‡é…ç½®
        const rowsConfig = [
            { count: 1, widths: ['w-12'] },
            { count: 2, widths: ['w-12', 'w-12'] },
            { count: 3, widths: ['w-16', 'w-12', 'w-16'] },
            { count: 4, widths: ['w-12', 'w-16', 'w-16', 'w-12'] },
            { count: 5, widths: ['w-12', 'w-12', 'w-16', 'w-12', 'w-12'] },
            { count: 6, widths: ['w-16', 'w-12', 'w-12', 'w-12', 'w-12', 'w-16'] },
            { count: 7, widths: ['w-12', 'w-16', 'w-12', 'w-16', 'w-12', 'w-16', 'w-12'] },
            { count: 8, widths: ['w-16', 'w-12', 'w-16', 'w-12', 'w-16', 'w-12', 'w-16', 'w-12'] },
        ];

        // è–èª•é…è‰²
        const colors = [
            'var(--active-green-light)',
            'var(--active-green-medium)',
            'var(--active-green-dark)',
            'var(--active-green-medium)', 
            'var(--active-green-light)',
            'var(--active-gold)',
            'var(--active-white)', 
            'var(--active-red)' 
        ];

        rowsConfig.forEach((row, rowIndex) => {
            const rowDiv = document.createElement('div');
            rowDiv.className = 'flex justify-center items-center';
            
            for (let i = 0; i < row.count; i++) {
                const switchEl = document.createElement('div');
                const widthClass = row.widths[i] || (Math.random() > 0.5 ? 'w-12' : 'w-16');
                const randomColor = colors[Math.floor(Math.random() * colors.length)];

                // ç›´æ¥åŠ å…¥ animating class
                switchEl.className = `switch ${widthClass} animating`; 
                switchEl.style.setProperty('--target-color', randomColor);

                const randomDelay = Math.random() * -5; 
                switchEl.style.animationDelay = `${randomDelay}s`;

                const knob = document.createElement('div');
                knob.className = 'knob knob-anim'; // ç›´æ¥åŠ å…¥ knob-anim
                knob.style.animationDelay = `${randomDelay}s`;

                switchEl.appendChild(knob);
                rowDiv.appendChild(switchEl);
            }
            container.appendChild(rowDiv);
        });

        // --- YouTube Player API è¨­å®š ---
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        var player;

        // æ’­æ”¾æ¸…å–® ID åˆ—è¡¨ (ç•¶é‡åˆ°ç‰ˆæ¬Šå•é¡Œæ™‚è‡ªå‹•åˆ‡æ›)
        const VIDEO_IDS = [
            'jgPByUmJ_n0',
            'uEoGR24CirQ',
            'zsFNoriSxHU',
            '7zuiHgFjIH0',
        ];
        
        let currentVideoIndex = 0;

        window.onYouTubeIframeAPIReady = function() {
            loadPlayer(VIDEO_IDS[currentVideoIndex]);
        };

        function loadPlayer(videoId) {
            player = new YT.Player('youtube-player', {
                height: '100%', 
                width: '100%',
                videoId: videoId, 
                playerVars: {
                    'autoplay': 1,
                    'controls': 1,
                    'loop': 1,
                    'playlist': videoId, // å¾ªç’°æ’­æ”¾
                    'playsinline': 1,
                    'origin': window.location.origin,
                    'modestbranding': 1
                },
                events: {
                    'onReady': onPlayerReady,
                    'onError': onPlayerError // è™•ç†æ’­æ”¾éŒ¯èª¤
                }
            });
        }

        function onPlayerReady(event) {
            // å˜—è©¦æ’­æ”¾ä¸¦è§£é™¤éœéŸ³
            event.target.unMute();
            event.target.playVideo();
        }

        // ç•¶ç™¼ç”ŸéŒ¯èª¤ (ä¾‹å¦‚å½±ç‰‡ç¦æ­¢åµŒå…¥) æ™‚è‡ªå‹•æ›ä¸‹ä¸€é¦–
        function onPlayerError(event) {
            console.log("Video Error, trying next one...");
            currentVideoIndex++;
            if (currentVideoIndex < VIDEO_IDS.length) {
                // éŠ·æ¯€èˆŠçš„ player ä¸¦å»ºç«‹æ–°çš„
                player.destroy(); 
                loadPlayer(VIDEO_IDS[currentVideoIndex]);
            }
        }

        // é»æ“ŠèƒŒæ™¯é‡æ–°éš¨æ©ŸåŒ–å»¶é² + ç¢ºä¿éŸ³æ¨‚æ’­æ”¾
        document.body.addEventListener('click', (e) => {
            // éš¨æ©ŸåŒ–
            const switches = document.querySelectorAll('.switch');
            switches.forEach(sw => {
                const newDelay = Math.random() * -5;
                sw.style.animationDelay = `${newDelay}s`;
                const knob = sw.querySelector('.knob');
                if(knob) knob.style.animationDelay = `${newDelay}s`;
            });
            
            // å˜—è©¦æ’­æ”¾ (å¦‚æœè‡ªå‹•æ’­æ”¾å¤±æ•—ï¼Œé»æ“Šç¶²é ä»»ä½•åœ°æ–¹ä¹Ÿæœƒè§¸ç™¼)
            if (player && player.getPlayerState && player.getPlayerState() !== 1) {
                player.unMute();
                player.playVideo();
            }
        });

    </script>
</body>
</html>
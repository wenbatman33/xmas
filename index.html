<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merry Christmas!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* * æ ¸å¿ƒé…è‰² 
         * ä¿®æ”¹ç‚ºã€Œç¶ æ¨¹ç´…åº•ã€é…è‰²
         */
        :root {
            --bg-color: #990000;       /* è–èª•ç´…èƒŒæ™¯ */
            
            /* æ¨¹çš„æœ¬é«”é¡è‰² (é—œé–‰ç‹€æ…‹) - æ”¹ç‚ºæ·±ç¶ è‰²ç³» */
            --switch-off-bg: #064e3b;  /* æ¥µæ·±ç¶ è‰² (æ¨¹è‘‰é™°å½±) */
            --knob-off: #166534;       /* æ·±ç¶ è‰² (æ¨¹è‘‰) */
            --knob-on: #ffffff;        /* é–‹å•Ÿæ™‚åœ“éˆ•ä¿æŒç™½è‰² */
            
            /* æ¨¹å¹¹é¡è‰² - åŠ æ·± */
            --trunk-bg: #281203;       /* æ›´æ·±çš„é»‘è¤è‰² */
            --trunk-knob: #451a03;     /* æ·±è¤è‰² */

            /* äº®èµ·æ™‚çš„é¡è‰²è®Šæ•¸ - å¢åŠ å¤šç¨®ç¶ è‰² */
            --active-green-light: #4ade80;   /* å«©ç¶ è‰²/äº®ç¶  */
            --active-green-medium: #22c55e;  /* æ­£ç¶ è‰² */
            --active-green-dark: #15803d;    /* æ·±ç¶ è‰² */
            
            /* é»ç¶´è‰² (è£é£¾å“) */
            --active-red: #ef4444;     
            --active-gold: #fbbf24;    
            --active-white: #f8fafc;   
        }

        body {
            background-color: var(--bg-color);
            font-family: 'Courier New', Courier, monospace;
            overflow: hidden; /* é˜²æ­¢æ²è»¸ */
            /* ç¢ºä¿å…§å®¹å‚ç›´ç½®ä¸­ */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        /* * é–‹é—œæœ¬é«” (å®¹å™¨)
         */
        .switch {
            position: relative;
            height: 28px;
            border-radius: 999px; /* è† å›Šå½¢ç‹€ */
            background-color: var(--switch-off-bg);
            cursor: pointer;
            transition: background-color 0.3s ease;
            display: inline-block;
            margin: 4px;
            /* åˆå§‹å¯¬åº¦ï¼Œæœƒè¢« JS è¦†è“‹ */
            width: 50px; 
            /* é¿å…æ‰‹æ©Ÿä¸Šé»æ“Šå‡ºç¾è—è‰²æ¡†æ¡† */
            -webkit-tap-highlight-color: transparent;
        }

        /* * é–‹é—œè£¡çš„åœ“éˆ• (Knob)
         */
        .knob {
            position: absolute;
            top: 4px;
            left: 4px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: var(--knob-off);
            transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* æ¨¹å¹¹å°ˆç”¨æ¨£å¼ (Disabled Switch) */
        .switch.trunk {
            background-color: var(--trunk-bg) !important;
            cursor: default;
            animation: none !important; /* å¼·åˆ¶ç§»é™¤å‹•ç•« */
            box-shadow: none;
        }
        .switch.trunk .knob {
            background-color: var(--trunk-knob) !important;
            transform: translateX(0) !important; /* å¼·åˆ¶ä¿æŒåœ¨å·¦å´ */
            animation: none !important;
        }

        /* * å‹•ç•«å®šç¾©
         * è®“é–‹é—œä¸æ–·åœ°å¾ Off -> On -> Off å¾ªç’°
         */
        @keyframes toggleLoop {
            0%, 10% { background-color: var(--switch-off-bg); }
            10% { background-color: var(--switch-off-bg); }
            20% { background-color: var(--target-color); }
            45%, 55% { background-color: var(--target-color); }
            65% { background-color: var(--target-color); }
            75%, 100% { background-color: var(--switch-off-bg); }
        }

        @keyframes knobLoop {
            0%, 10% { transform: translateX(0); background-color: var(--knob-off); }
            20%, 65% { transform: translateX(calc(100% + 4px)); background-color: var(--knob-on); }
            75%, 100% { transform: translateX(0); background-color: var(--knob-off); }
        }

        /* æ‡‰ç”¨å‹•ç•«çš„é¡åˆ¥ */
        .animating {
            animation: toggleLoop 4s infinite ease-in-out;
        }
        
        /* Knob ä½ç§»è·é›¢å‹•ç•« */
        .switch.w-12 .knob-anim { animation: knobMoveSmall 4s infinite ease-in-out; }
        .switch.w-16 .knob-anim { animation: knobMoveMedium 4s infinite ease-in-out; }
        .switch.w-20 .knob-anim { animation: knobMoveLarge 4s infinite ease-in-out; }
        /* ç‚ºåˆä½µå¾Œçš„æ¨¹å¹¹å¢åŠ ä¸€å€‹å°æ‡‰çš„å¯¬åº¦å‹•ç•« (é›–ç„¶æ¨¹å¹¹ä¸ä¸€å®šå‹•ï¼Œä½†è‹¥æœ‰éœ€è¦å¯æ“´å……) */
        .switch.w-24 .knob-anim { animation: knobMoveXLarge 4s infinite ease-in-out; }

        @keyframes knobMoveSmall {
            0%, 15% { transform: translateX(0); background-color: var(--knob-off); }
            25%, 60% { transform: translateX(20px); background-color: var(--knob-on); } 
            70%, 100% { transform: translateX(0); background-color: var(--knob-off); }
        }
        @keyframes knobMoveMedium {
            0%, 15% { transform: translateX(0); background-color: var(--knob-off); }
            25%, 60% { transform: translateX(36px); background-color: var(--knob-on); }
            70%, 100% { transform: translateX(0); background-color: var(--knob-off); }
        }
        @keyframes knobMoveLarge {
            0%, 15% { transform: translateX(0); background-color: var(--knob-off); }
            25%, 60% { transform: translateX(52px); background-color: var(--knob-on); }
            70%, 100% { transform: translateX(0); background-color: var(--knob-off); }
        }
        @keyframes knobMoveXLarge {
            0%, 15% { transform: translateX(0); background-color: var(--knob-off); }
            25%, 60% { transform: translateX(68px); background-color: var(--knob-on); }
            70%, 100% { transform: translateX(0); background-color: var(--knob-off); }
        }

        /* * Logo æ¨£å¼ 
         */
        .logo-text {
            color: #fff;
            letter-spacing: 4px;
            font-weight: 700;
            opacity: 0.9;
            transition: all 0.3s;
        }
        .logo-accent {
            color: var(--active-gold); /* é‡‘è‰² */
        }

        /* YouTube å°è¦–çª—æ¨£å¼ */
        .video-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 240px;
            height: 135px; /* 16:9 æ¯”ä¾‹ */
            z-index: 100;
            border: 4px solid var(--active-gold);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            background-color: #000;
            opacity: 1; 
            transition: transform 0.3s ease;
        }
        .video-container:hover {
            transform: scale(1.05);
        }
        .video-label {
            position: absolute;
            top: -25px;
            right: 0;
            color: var(--active-gold);
            font-size: 12px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        /* -------------------------------------
           æ‰‹æ©Ÿç‰ˆå„ªåŒ– (Mobile Optimization)
           ------------------------------------- */
        @media (max-width: 768px) {
            /* 1. ç¸®å°æ•´æ£µæ¨¹ */
            #tree-container {
                transform: scale(0.65); /* ç¸®å°è‡³ 65% */
                margin-bottom: -2rem;   /* èª¿æ•´å› ç‚ºç¸®å°ç”¢ç”Ÿçš„ç©ºç™½ */
            }

            /* 2. ç¸®å°å½±ç‰‡è¦–çª—ï¼Œé¿å…æ“‹ä½å¤ªå¤š */
            .video-container {
                width: 160px;
                height: 90px;
                bottom: 15px;
                right: 15px;
                border-width: 2px;
            }
            .video-label {
                font-size: 10px;
                top: -18px;
            }

            /* 3. èª¿æ•´æ–‡å­—å¤§å° */
            .logo-text {
                font-size: 1.1rem;
                margin-top: 0px;
            }
        }
        
        /* é‡å°æ›´å°çš„è¢å¹• (ä¾‹å¦‚ iPhone SE) */
        @media (max-width: 380px) {
             #tree-container {
                transform: scale(0.55); /* ç¸®å¾—æ›´å° */
            }
        }
    </style>
</head>
<body>

    <!-- YouTube æ’­æ”¾å™¨å®¹å™¨ (å³ä¸‹è§’) -->
    <div class="video-container">
        <!-- æ¨™ç±¤èªªæ˜ -->
        <div class="video-label">BGM: Christmas Vibes ğŸµ</div>
        <div id="youtube-player"></div>
    </div>

    <!-- ä¸»è¦å®¹å™¨ -->
    <div id="tree-container" class="flex flex-col items-center gap-2 mb-12">
        <!-- Javascript æœƒåœ¨é€™è£¡ç”Ÿæˆé–‹é—œ -->
    </div>

    <!-- åº•éƒ¨æ–‡å­— -->
    <div class="logo-text text-xl">
        <span class="logo-accent">Merry</span> Christmas!
    </div>

    <script>
        const container = document.getElementById('tree-container');

        // å®šç¾©æ¯ä¸€å±¤çš„é–‹é—œæ•¸é‡èˆ‡é…ç½®
        const rowsConfig = [
            // æ¨¹è‘‰éƒ¨åˆ†
            { count: 1, widths: ['w-12'] },
            { count: 2, widths: ['w-12', 'w-12'] },
            { count: 3, widths: ['w-16', 'w-12', 'w-16'] },
            { count: 4, widths: ['w-12', 'w-16', 'w-16', 'w-12'] },
            { count: 5, widths: ['w-12', 'w-12', 'w-16', 'w-12', 'w-12'] },
            { count: 6, widths: ['w-16', 'w-12', 'w-12', 'w-12', 'w-12', 'w-16'] },
            { count: 7, widths: ['w-12', 'w-16', 'w-12', 'w-16', 'w-12', 'w-16', 'w-12'] },
            { count: 8, widths: ['w-16', 'w-12', 'w-16', 'w-12', 'w-16', 'w-12', 'w-16', 'w-12'] },
            
            // æ¨¹å¹¹éƒ¨åˆ† (ä½¿ç”¨ type: 'trunk' æ¨™è¨˜)
            // ä¿®æ”¹ç‚ºå–®ä¸€åˆä½µçš„å¯¬æ¨¹å¹¹ (w-24)
            { count: 1, widths: ['w-24'], type: 'trunk' },
            { count: 1, widths: ['w-24'], type: 'trunk' },
        ];

        // è–èª•é…è‰²
        const colors = [
            'var(--active-green-light)',
            'var(--active-green-medium)',
            'var(--active-green-dark)',
            'var(--active-green-medium)', 
            'var(--active-green-light)',
            'var(--active-gold)',
            'var(--active-white)', 
            'var(--active-red)' 
        ];

        rowsConfig.forEach((row, rowIndex) => {
            const rowDiv = document.createElement('div');
            rowDiv.className = 'flex justify-center items-center';
            
            for (let i = 0; i < row.count; i++) {
                const switchEl = document.createElement('div');
                const widthClass = row.widths[i] || (Math.random() > 0.5 ? 'w-12' : 'w-16');
                
                // åˆ¤æ–·æ˜¯å¦ç‚ºæ¨¹å¹¹
                const isTrunk = row.type === 'trunk';
                
                if (isTrunk) {
                    // æ¨¹å¹¹ï¼šä¸åŠ å‹•ç•« classï¼ŒåŠ å…¥ trunk class
                    switchEl.className = `switch ${widthClass} trunk`;
                } else {
                    // æ¨¹è‘‰ï¼šåŠ å…¥éš¨æ©Ÿé¡è‰²èˆ‡å‹•ç•«
                    const randomColor = colors[Math.floor(Math.random() * colors.length)];
                    switchEl.className = `switch ${widthClass} animating`; 
                    switchEl.style.setProperty('--target-color', randomColor);
                    
                    const randomDelay = Math.random() * -5; 
                    switchEl.style.animationDelay = `${randomDelay}s`;
                }

                const knob = document.createElement('div');
                
                if (isTrunk) {
                    // æ¨¹å¹¹æŒ‰éˆ•ï¼šç„¡å‹•ç•«
                    knob.className = 'knob';
                } else {
                    // æ¨¹è‘‰æŒ‰éˆ•ï¼šæœ‰å‹•ç•«
                    knob.className = 'knob knob-anim'; 
                    // å¿…é ˆèˆ‡çˆ¶å±¤ switch å»¶é²åŒæ­¥
                    knob.style.animationDelay = switchEl.style.animationDelay;
                }

                switchEl.appendChild(knob);
                rowDiv.appendChild(switchEl);
            }
            container.appendChild(rowDiv);
        });

        // --- YouTube Player API è¨­å®š ---
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        var player;

        // æ’­æ”¾æ¸…å–® - å·²æ›´æ–°
        const VIDEO_IDS = [
            'jgPByUmJ_n0',
            'uEoGR24CirQ',
            'zsFNoriSxHU',
            '7zuiHgFjIH0',
        ];
        
        let currentVideoIndex = 0;

        window.onYouTubeIframeAPIReady = function() {
            loadPlayer(VIDEO_IDS[currentVideoIndex]);
        };

        function loadPlayer(videoId) {
            player = new YT.Player('youtube-player', {
                height: '100%', 
                width: '100%',
                videoId: videoId, 
                playerVars: {
                    'autoplay': 1,
                    'controls': 1,
                    'loop': 1,
                    'playlist': videoId, 
                    'playsinline': 1,
                    'origin': window.location.origin,
                    'modestbranding': 1
                },
                events: {
                    'onReady': onPlayerReady,
                    'onError': onPlayerError
                }
            });
        }

        function onPlayerReady(event) {
            event.target.unMute();
            event.target.playVideo();
        }

        function onPlayerError(event) {
            console.log("Video Error, trying next one...");
            currentVideoIndex++;
            if (currentVideoIndex < VIDEO_IDS.length) {
                player.destroy(); 
                loadPlayer(VIDEO_IDS[currentVideoIndex]);
            }
        }

        document.body.addEventListener('click', (e) => {
            // éš¨æ©ŸåŒ–å‹•ç•« (åªé‡å°éæ¨¹å¹¹çš„é–‹é—œ)
            const switches = document.querySelectorAll('.switch:not(.trunk)');
            switches.forEach(sw => {
                const newDelay = Math.random() * -5;
                sw.style.animationDelay = `${newDelay}s`;
                const knob = sw.querySelector('.knob');
                if(knob) knob.style.animationDelay = `${newDelay}s`;
            });
            
            // ç¢ºä¿æ’­æ”¾
            if (player && player.getPlayerState && player.getPlayerState() !== 1) {
                player.unMute();
                player.playVideo();
            }
        });

    </script>
</body>
</html>